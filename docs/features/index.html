<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.70">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Shopify Packer Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Shopify Packer Blog Atom Feed"><title data-react-helmet="true">Bundles | Shopify Packer</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Bundles | Shopify Packer"><meta data-react-helmet="true" name="description" content="Template and layout bundles are a build-time optimization which ensures"><meta data-react-helmet="true" property="og:description" content="Template and layout bundles are a build-time optimization which ensures"><meta data-react-helmet="true" property="og:url" content="https://hayes0724.github.io/shopify-packer/docs/features"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://hayes0724.github.io/shopify-packer/docs/features"><link rel="stylesheet" href="/styles.a23773b3.css">
<link rel="preload" href="/styles.670906f7.js" as="script">
<link rel="preload" href="/runtime~main.65a4ac1f.js" as="script">
<link rel="preload" href="/main.27861c20.js" as="script">
<link rel="preload" href="/1.e94733a0.js" as="script">
<link rel="preload" href="/20.0b45cec4.js" as="script">
<link rel="preload" href="/21.8c4ba247.js" as="script">
<link rel="preload" href="/f976f453.77424a4f.js" as="script">
<link rel="preload" href="/19.f72a81f2.js" as="script">
<link rel="preload" href="/7d541487.9508b0cf.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav aria-label="Skip navigation links"><button type="button" tabindex="0" class="skipToContent_11B0">Skip to main content</button></nav><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><strong class="navbar__title">Shopify Packer</strong></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs">Docs</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/hayes0724/shopify-packer" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2N3Q"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_3NWk">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_3NWk">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><strong class="navbar__title">Shopify Packer</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/docs">Docs</a></li><li class="menu__list-item"><a href="https://github.com/hayes0724/shopify-packer" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_vMrn"><div class="docSidebarContainer_3Ak5" role="complementary"><div class="sidebar_3gvy"><div class="menu menu--responsive thin-scrollbar menu_1yIk"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_1CUI" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Getting Started</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/install">Install</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/quick-start">Quick start</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/commands">Commands</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ssl">HTTPS &amp; SSL</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/structure">Structure</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Configuration</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config">Files</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config/environment">Environment</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config/settings">App settings</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config/webpack">Webpack</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Features</a><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs/features">Bundles</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/features/liquid-styles">Liquid styles</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/features/admin-api">Shopify Admin API</a></li></ul></li></ul></div></div></div><main class="docMainContainer_2iGs"><div class="container padding-vert--lg docItemWrapper_1bxp"><div class="row"><div class="col docItemCol_U38p"><div class="docItemContainer_a7m4"><article><header><h1 class="docTitle_Oumm">Bundles</h1></header><div class="markdown"><p>Template and layout bundles are a build-time optimization which ensures
that only the JS and CSS needed for the current page is downloaded and
executed. This optimization results in improved page load speed,
especially on mobile devices with limited computing power and network capacity.</p><p>In order to take advantage of template and layout bundles,
your Packer project&#x27;s src/script/ folder must include the following folders:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">â””â”€â”€ src</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   â””â”€â”€ scripts</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   â”‚   â”œâ”€â”€ layout</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   â”‚   â””â”€â”€ templates</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   â”œâ”€â”€ layout</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   â””â”€â”€ templates</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="automatic-bundle-creation"></a>Automatic bundle creation<a class="hash-link" href="#automatic-bundle-creation" title="Direct link to heading">#</a></h3><p>On build, Packer will look for each file in the src/scripts/layout and
src/scripts/templates folders and see if there is a matching file
in the src/layout and src/templates folders. If there is a match, a
template or layout bundle is created for that match.</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">â””â”€â”€ src</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   â””â”€â”€ scripts</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   â”‚   â”œâ”€â”€ layout</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   â”‚   â”‚   â””â”€â”€ theme.js</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   â”‚   â””â”€â”€ templates</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   â”‚       â”œâ”€â”€ index.js</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   â”‚       â””â”€â”€ product.js</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   â”œâ”€â”€ layout</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   â”‚   â””â”€â”€ theme.liquid</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   â””â”€â”€ templates</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">       â”œâ”€â”€ index.liquid</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">       â””â”€â”€ product.liquid</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Using the example above and calling packer build, Packer will look for matching template and
layout files inside the src/scripts/ folder and generate the following JS bundles:</p><ul><li><code>layout.theme.js</code>: Both <code>theme.liquid</code> and <code>theme.js</code> exist.</li><li><code>template.index.js</code>: Both <code>index.liquid</code> and <code>index.js</code> exist.</li><li><code>template.product.js</code>: Both <code>product.liquid</code> and <code>product.js</code> exist.</li></ul><p>Note that the following bundles <strong>are not</strong> generated:</p><ul><li><code>template.page.about-us.js</code>: Packer cannot find a <code>src/template/page.about-us.liquid</code> file.</li><li><code>template.collection.js</code>: Packer cannot find a <code>scripts/templates/collection.js</code> file.</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="shared-js-dependencies-chunking"></a>Shared JS dependencies chunking<a class="hash-link" href="#shared-js-dependencies-chunking" title="Direct link to heading">#</a></h3><p>A critical optimization needed for template and layout bundles to be successful
is to split shared dependencies between bundles into separate chunks.
This reduces the amount of duplicate code included in each bundle and
further improves page load performance.</p><p>Let&#x27;s continue with the file structure from the previous example, and
see how shared dependencies are separated:</p><p><em>index.js</em></p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">@import depA from &#x27;depA&#x27;;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">@import depB from &#x27;depB&#x27;;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p><em>index.js</em></p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">@import depB from &#x27;depB&#x27;;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">@import depC from &#x27;depC&#x27;;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>In the example above, we have 2 files which each import 2 dependencies.
Both files have a shared dependency, depB. Instead of bundling depB into
template.index.js and again in template.product.js, Packer splits depB
into its own bundle chunk. The resulting generated files are:</p><ul><li><code>template.index.js</code>: Code that is only used on the index template.</li><li><code>template.product.js</code>: Code that is only used on the product template.</li><li><code>template.index@template.product.js</code>: Code that is used on both index and product templates.</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="template-and-layout-styles"></a>Template and layout styles<a class="hash-link" href="#template-and-layout-styles" title="Direct link to heading">#</a></h3><p>It&#x27;s also possible to structure your styles so that only those needed
for the current page are loaded. This is made possible by the JS bundling
mentioned above. Let&#x27;s take a look at what a typical Packer project might
look like and how it would take advantage of template and layout styles.</p><p><em>layout/theme.js</em></p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-scss codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">import </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;../../styles/layout/theme.scss&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p><em>layout/product.js</em></p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-scss codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">import </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;../../styles/templates/product.scss&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Looking at the above examples, we can see that we are importing two
different SCSS files. We can expect that <code>theme.scss</code> contains global
styles that are used through most of the theme&#x27;s pages, such as header
and navigation styles. <code>product.scss</code> might include styles that are
specific to the product template, such as a product image gallery.</p><p>The following imports would generate the following files:</p><ul><li><code>layout.theme.css.liquid</code></li><li><code>template.product.css.liquid</code></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="including-generated-bundles-in-your-theme"></a>Including generated bundles in your theme<a class="hash-link" href="#including-generated-bundles-in-your-theme" title="Direct link to heading">#</a></h3><p>Now that you have template and layout bundles with shared dependency chunking,
you&#x27;ll notice that there are a lot of JS files in your compiled Packer project
(found in the dist folder). It would be pretty tedious to code and manage
all the <code>&lt;script&gt;</code> tags for each of these assets. So let&#x27;s have Packer handle this!</p><p>packer generates <code>script-tags.liquid</code> and <code>styles-tags.liquid</code> snippets
which include <code>&lt;script&gt;</code> and <code>&lt;link&gt;</code> tags needed for each bundle.
These snippets also include all the liquid logic needed to selectively load
these bundles based on the current template and layout.
All you need to do is include these snippets in your layout files.</p><p>For example, here is what you would include in your <code>layout/theme.liquid</code>:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">{% include &#x27;style-tags&#x27; %}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">{% include &#x27;script-tags&#x27;, layout: &#x27;theme&#x27; %}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>where the layout option value is the name of the layout.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="bundle-analyzer"></a>Bundle analyzer<a class="hash-link" href="#bundle-analyzer" title="Direct link to heading">#</a></h3><p>Packer&#x27;s <a href="/docs/commands#build">build script</a> can use Webpack Bundle Analyzer to see what&#x27;s inside each bundle for further optimization</p><p><img alt="Bundle Analyzer" src="/assets/images/webpack-bundle-analyzer-0fac122b5b5a74559bfc0612d7dea1dc.png"></p></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/facebook/docusaurus/edit/master/website/docs/features/bundles.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2LL7"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/config/webpack"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Webpack</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/features/liquid-styles"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Liquid styles Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_2xL- thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#automatic-bundle-creation" class="table-of-contents__link">Automatic bundle creation</a></li><li><a href="#shared-js-dependencies-chunking" class="table-of-contents__link">Shared JS dependencies chunking</a></li><li><a href="#template-and-layout-styles" class="table-of-contents__link">Template and layout styles</a></li><li><a href="#including-generated-bundles-in-your-theme" class="table-of-contents__link">Including generated bundles in your theme</a></li><li><a href="#bundle-analyzer" class="table-of-contents__link">Bundle analyzer</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs">Getting Started</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/config">Configuration</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/features">Features</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a href="https://github.com/hayes0724/shopify-packer/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Github</a></li><li class="footer__item"><a href="https://github.com/hayes0724/shopify-packer/issues" target="_blank" rel="noopener noreferrer" class="footer__link-item">Issues</a></li><li class="footer__item"><a href="https://github.com/hayes0724/shopify-packer/discussions" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discussions</a></li></ul></div></div><div class="footer__bottom text--center"></div></div></footer></div>
<script src="/styles.670906f7.js"></script>
<script src="/runtime~main.65a4ac1f.js"></script>
<script src="/main.27861c20.js"></script>
<script src="/1.e94733a0.js"></script>
<script src="/20.0b45cec4.js"></script>
<script src="/21.8c4ba247.js"></script>
<script src="/f976f453.77424a4f.js"></script>
<script src="/19.f72a81f2.js"></script>
<script src="/7d541487.9508b0cf.js"></script>
</body>
</html>